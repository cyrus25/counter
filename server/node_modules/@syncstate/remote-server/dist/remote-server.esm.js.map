{"version":3,"file":"remote-server.esm.js","sources":["../src/remoteServer.ts"],"sourcesContent":["export type ChangeReadyCallback = (path: string, change: any) => void;\n\nexport default class SyncStateRemote {\n  changeReadyMap = new Map<string, Array<ChangeReadyCallback>>();\n\n  processChange(clientId: string, path: string, change: any) {\n    setTimeout(() => {\n      let changeReadyCallbacks = this.changeReadyMap.get(clientId);\n      if (changeReadyCallbacks) {\n        changeReadyCallbacks.forEach(cb => {\n          cb(path, change);\n        });\n      }\n    }, 1000);\n  }\n\n  onChangeReady(clientId: string, cb: ChangeReadyCallback) {\n    let changeReadyCallbacks = this.changeReadyMap.get(clientId);\n\n    if (!changeReadyCallbacks) {\n      changeReadyCallbacks = [];\n      this.changeReadyMap.set(clientId, changeReadyCallbacks);\n    }\n    const newLength = changeReadyCallbacks.push(cb);\n\n    return () => {\n      if (changeReadyCallbacks) {\n        changeReadyCallbacks.splice(newLength - 1, 1);\n      }\n    };\n  }\n}\n"],"names":["SyncStateRemote","Map","processChange","clientId","path","change","setTimeout","changeReadyCallbacks","changeReadyMap","get","forEach","cb","onChangeReady","set","newLength","push","splice"],"mappings":"IAEqBA;AAArB;AACE,uBAAA,GAAiB,IAAIC,GAAJ,EAAjB;AA4BD;;;;SA1BCC,gBAAA,uBAAcC,QAAd,EAAgCC,IAAhC,EAA8CC,MAA9C;;;AACEC,IAAAA,UAAU,CAAC;AACT,UAAIC,oBAAoB,GAAG,KAAI,CAACC,cAAL,CAAoBC,GAApB,CAAwBN,QAAxB,CAA3B;;AACA,UAAII,oBAAJ,EAA0B;AACxBA,QAAAA,oBAAoB,CAACG,OAArB,CAA6B,UAAAC,EAAE;AAC7BA,UAAAA,EAAE,CAACP,IAAD,EAAOC,MAAP,CAAF;AACD,SAFD;AAGD;AACF,KAPS,EAOP,IAPO,CAAV;AAQD;;SAEDO,gBAAA,uBAAcT,QAAd,EAAgCQ,EAAhC;AACE,QAAIJ,oBAAoB,GAAG,KAAKC,cAAL,CAAoBC,GAApB,CAAwBN,QAAxB,CAA3B;;AAEA,QAAI,CAACI,oBAAL,EAA2B;AACzBA,MAAAA,oBAAoB,GAAG,EAAvB;AACA,WAAKC,cAAL,CAAoBK,GAApB,CAAwBV,QAAxB,EAAkCI,oBAAlC;AACD;;AACD,QAAMO,SAAS,GAAGP,oBAAoB,CAACQ,IAArB,CAA0BJ,EAA1B,CAAlB;AAEA,WAAO;AACL,UAAIJ,oBAAJ,EAA0B;AACxBA,QAAAA,oBAAoB,CAACS,MAArB,CAA4BF,SAAS,GAAG,CAAxC,EAA2C,CAA3C;AACD;AACF,KAJD;AAKD;;;;;;;"}