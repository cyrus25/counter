{"version":3,"file":"remote-server.cjs.production.min.js","sources":["../src/remoteServer.ts"],"sourcesContent":["export type ChangeReadyCallback = (path: string, change: any) => void;\n\nexport default class SyncStateRemote {\n  changeReadyMap = new Map<string, Array<ChangeReadyCallback>>();\n\n  processChange(clientId: string, path: string, change: any) {\n    setTimeout(() => {\n      let changeReadyCallbacks = this.changeReadyMap.get(clientId);\n      if (changeReadyCallbacks) {\n        changeReadyCallbacks.forEach(cb => {\n          cb(path, change);\n        });\n      }\n    }, 1000);\n  }\n\n  onChangeReady(clientId: string, cb: ChangeReadyCallback) {\n    let changeReadyCallbacks = this.changeReadyMap.get(clientId);\n\n    if (!changeReadyCallbacks) {\n      changeReadyCallbacks = [];\n      this.changeReadyMap.set(clientId, changeReadyCallbacks);\n    }\n    const newLength = changeReadyCallbacks.push(cb);\n\n    return () => {\n      if (changeReadyCallbacks) {\n        changeReadyCallbacks.splice(newLength - 1, 1);\n      }\n    };\n  }\n}\n"],"names":["Map","processChange","clientId","path","change","setTimeout","changeReadyCallbacks","_this","changeReadyMap","get","forEach","cb","onChangeReady","this","set","newLength","push","splice"],"mappings":"wIAGmB,IAAIA,+BAErBC,cAAA,SAAcC,EAAkBC,EAAcC,cAC5CC,YAAW,eACLC,EAAuBC,EAAKC,eAAeC,IAAIP,GAC/CI,GACFA,EAAqBI,SAAQ,SAAAC,GAC3BA,EAAGR,EAAMC,QAGZ,QAGLQ,cAAA,SAAcV,EAAkBS,OAC1BL,EAAuBO,KAAKL,eAAeC,IAAIP,GAE9CI,QAEEE,eAAeM,IAAIZ,EADxBI,EAAuB,QAGnBS,EAAYT,EAAqBU,KAAKL,UAErC,WACDL,GACFA,EAAqBW,OAAOF,EAAY,EAAG"}